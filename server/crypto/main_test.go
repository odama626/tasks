package crypto

import (
	"encoding/hex"
	"testing"
)

func TestVerifySignature(t *testing.T) {
	signature := "32b2329a6c420481740d932578190c305ec629e8188ccd7cc6bc69b1544d5e1f57b00e4604c00d40c5e385865182da7de6374a688104632d4518c47c611b3f58e4c66dc8e4b364584a68950e39f2b6cd7d87f260daefce57da70b69bcadd457054c31650e9529064993550446cd4f71fa4d91fb5eed2e9be1362746242366cc36089741cff6232aec318391409ea2f370ef540cbf4e8c1944c114dd400155aa9483f69b2f0c413b05364a42593f5168aef5054bc4e2febed939ba69f7c5d1459009271d420422e6ecc53e3e2dd7c69915a3e1a4cb81433db6e6ed19325a9f665d9f3d8d96a2f52dceadef1530348e503ff5e7f0272c659b317f0715fdfdfa29d7b9ec1c8887c23ff17faeecabfcfa16f6bc3298a0d1f4e4e2e9c4ec5917740fb69efc6231caae966133e74f55a50ec2b2b912c58fb2ec6bf1217b0d3cd1143fe81611934b40c2f2cceb17ba0a883cd593e081cac4135b0f0e84c010d1b25909a1ad6f83ce824121d2cfd8f09a575dc5ddad364ea3e31e1d6a77826032ce5d8936bad0b69419c1862b0715ec7f9e63b3100e279b85fb3e0e10c23b658e42d7aa0d5ed4a23e6a1a112de962495854340dcb028acdf5ae7a94cee52275234b0d894adb7c0b4106c618cedab23a4e3f979fd55a68d11aa08c10101158994faba67a5ec1aa4b8db1c6f5e5bd40f7a1fe1fbc56945f82baf7cb78464a3239e5415145d"
	publicKeyString := `{"alg":"RS512","e":"AQAB","ext":true,"key_ops":["verify"],"kty":"RSA","n":"kFdEbpFvSP7Y9I1qiVVZfpktN5ijl4eLzEKO4gfywwbjwDzfjH9n4aRW1Ez4ebHBsPXqLELTDFge-3xJ8ndQ_jrl2sEr4DKLeXLxmzNchzuHFsxnCqccuq_M_I-nmOau6J2yfU3VClosJF9ijpMxWjcRINKuVSe4AKn508HYyoD1b0nBCLP-01Qi_BrVzcNaebjSZYD0-BaUZYUW328KpqLgDUC8as-DskkkbXU2nbojbyjq1Jns9o1ar_JPzgmSz7QzT5zrJNN1j2zpgMW3hs71WXPNaOONJjJ6HXbW0YicL-s7hTD-FT4plNqZZ7evxrfnhDfLjLOMMm6O7zJc5z0lwFpzdKrRZxUkDR3epCHmYwFFsmpyZRJ5Jzlr2S_9KXcXwEjzSAnwCua9s3sCRVeq7xcgePs2E90nKHd0L0RTxxFhTBOdzYMf1jMAtWED7ZmUWHm8TFVpUY64BCNwE8MK6NGELcXbtG-o_wECtI_10M2PuJ5tWUAb8A9x0GKNLK2b2ctUeFV9h3rviblNJDorNvjrpNNyWQSMDi7pRrodj10jNiNpCPiCkPaHzLFI1r9G23GcZrHuHjgjQ2Tmq4OMwlUePuBLCvpQDo9lz4b_V-ff-eMR6Rm6hKuUdW6aAPYNcQ4Bngqf_ABWrPxT3RPp-huXe9mNEvzQhSaN488"}`
	payloadHex := `d0150000026e616d6500090000004a6f686e20446f6500037075626c69634b6579000a03000002616c67000d0000005253412d4f4145502d35313200026500050000004151414200086578740001046b65795f6f7073001400000002300008000000656e63727970740000026b7479000400000052534100026e00ac0200006c317746526e6d34576f52514b5745754b615a584344334765476c445671796a302d506345587444476537393642614c51327255414648486e55714332776154693769535a48554d58426d55334f657a695a686a7a2d424d794a576a4e5a6c2d504e4639345555366b65364272326c37774f72794a576f56417550787767513869375f47776c364d78664b65764d756d736d4d714443434e535a4a43567973704a46615a6f6146513857766257456f6f757857516e77444d72674a7266453351754c79424b346b696764394d634136744868666846585157726b67575f70737179574a4d735268715f787339334447354a5f5a77616c4b66765f4c615f7149747849746a594475797a565957316a2d34466e71387a694769344f55344635327236554c7063315344636330752d414f77643969525f374b324c4f51395843584f68325a5836613657565962694e4865776c5769634c5a647771786672424647686b4e5f4a4f4b3143335878567a56785179496363527861766b646669575a6d5946417143442d493678775244312d4464346f5a77316d71735938756b6a425f656c5f544631556b49414a5a4256455a352d595550586b4b36746631615a7242654b7230706230392d356a633067686b4a415f38686b6b39444d654c55746a3765534a70666f744a443958336f34686665344e4763626c57516c75314732354f697879514d6d334b4d464b446e446558654f44454c2d446e4b72474431364845566a7036634b5a30714548427653556a775a5469585a392d7948736f6278365738794f35646d52342d4677516e41415a413473307147484279493337687251744a5059683968473167434f41343475582d47495f596b31746d6b677a69544e30724a39356c6265375a7465456d2d736a3831497159696d653831425673396c4c77354f354b486f43615a6a55000002707269766174654b6579486173686564008d12000035306262663233396364326530663334363864396663303031323161313663343666383936336333323436383761393037313237643162626165363263353534626431383535343436623161313263643333316430383437343935656461343965646263613934353961323839663362313834303261303165386665656662353665313366313764346537366330326266363937383135616632383661323239376466326537336130333235373166316530336630366230376664643466383765656530316666386139646334663364636562626564613464646466333262313264323765363361616137656530653335343734626664626238343231343938373335353738336231313161383033323762363030343135643764376430356334653462393638383764613631653766356362383865333135626537303631313938353866373139366536653936316331376430663764633634303736353936323736643135363636386335616262646233336539663564646132646636336365393133613433656530636661326163316639643533323832646139656137376566343339346162663864373164626665623365663262616137306533326165346636366638386563356437353466313730373838663563343966363562356334386161656434383839326630353839353064633038383063386136313032373935366138613037323262613634383837656639343635366436623133393030306639626238646666303434383038663566333165373931383339376132663431643335663464653937323134663066313331313231316630616430656461363761666163393630636530363162623631333066333637363030613032623336303230613562393834343461303136653835383361376438386238643766383036616663373031393161303932363262336133323961386261643632353533623333666164326463336437656430643433393636376632383536383531353232373364626331643933396138303361353563653061636130383263633964666165366437383230363534326535363861323735373062333934383833306639333735383833356131643834313835376630373537626364316535386434613831356131303061656564366263636431613832326466373939623164306235303039306465353666666135376138633035646136313639623661396565626662353831613935333261353137306566396337643934303962626361383735366235646265663231633632646361663466346164373739633662633262666461373562373939343430343537303434656561653530353939306561376363633736653839376565623761313161653237333366313964363531313332313964653134663639333234623737363363353439323135343430373234333633303938393061363437653136376438303432613635666462376361666335326562623932393264386534333630626164313332396535366438666637386364663835343538656234303230393662653462346361343736626230306264333363363964636630333664643266636238343561623838643762666137666536386461353265343362363564333936663563336131613664616465643066646232313435326163373138363632303739353761643561363333643661313438643062393765666265396532393266623238346366626536643335376362376431383231393361356264396231626630386566386461303033373639653232396238626330323264663864623762376261346630393564313736343764396463363933323065616330366463316336303938656131343462653966623035666565313738376136323663323865643433313734353762353135316237653132633438326139663963393335316465633062643537336339373636343230393737373861626562376336663036646434333130303838353438303337613137383262303762343338313462383765386461323031346136333965393231323339653761323638376533343363646232663339663334636263343734396431313762633839303632353863393462333865386533633865363433666265636331663833623231656264353266333035623865326635643265393461373131306432363738613033376636303661323733636136373431633464316462653363383761633233303063626137346466393431383361303833663862316263326130366162393865366661363962366434336465336562376135383266623130303862353638373433613933373462643164323031366239633439383238626430336566396535626463376561326236393931633132616336303661613130646431303730663030323133326535613932323064653836336365653966366162663036366332316530386163613031323335366334653661326364373136353932396134366134306535356639396365666538663563373735336165306334396633653839306564353963366135353332613366386661343439303334623963663461643663376364643065396237353265633433343230373666393631646262383535353361393739633263663032636435313135616330373561353165663062363162386266326363366666636665656664396536393032326235363163646365393933613732643635396430303538663238383432643065313037643564313766323966646439326235643839643366343236393663656634323536363930613265303035333162653934343363356137633434373332663938303539376331396235373536633561346366396337306666353561326130333865623863396664326531316166393030373737336465373366303938363739653233633462383964353866343737623234656331333038396262303161363131623737306537326539623033376232306466653038383166306134666165376663326262636134643161623862393161376331633138383931313837373061626666366131626239623636313238613866353863326238616164616331323630396137613465386361326366626361666361383662313261316362396635393230333466306139336161326663383665633564353834373563333037306336346365386364366362626438326431633065323934303863643230613430353030383862626239373464333839306464646138643639633662323837303230386436326239646265346561353035306537353534383837396434326164313261666461386230373938393562346665626237356634306336323334373437363664386634363337623330336132333136353663333935346232616635363431366561333330316230346633336565666636353338306230376461363339346632353266353834613532336464643063653231373238653131353437306364306431646462653530383232636137633037343030383333616663313764323439656464623162386237323863313037323131353838326164613666386638323764636639393538626365383538353965626639373865393831613764346161326439343365353135393266633839626433303639383034643735393264636432636165373362356431383434666638626164393132616162326438383263383038636635343464376138313735653866386236613164393661666565326232363332313930663834666339616166356437383634633364373535643533313464653761353565373836303264353639343039626264393263646134643762393837346332336633323761633362663266613034656334316339666239386434633739383364626164643531343962633730363961363434363264643032666533383337336239366233386364383830333663343036373330623732303962653964653934613263343835373165393339323865663433646130333436376438643461396339666230636234333832356436626337663638373863393161623965613162386238386534386535613365646431383038326661303632383230373137356661653365326137633562633461316136626233326639633266306238623731326132313161353062316631623835346135623933376262313236316638373363303731393136616236616462623931326230396665333630343165343630343964393432373736383061383063656162623538363265306564663639323937636462363361333664643831353634373863303561356136386432353835616262643630636532306364363937663263366563363535323639393534663938353537366535336463626264346463316161626534363665373166646534353739323038646536303138396463363534643939383834343563626630653035393761363730366362323235623264353738323665366561313938323963393631303738313835326537663937623830303130363532626231343638313232303765643830396133343463323761613661363763336465386436386339613263373632626237343831613361653365363735376563343634336164313263333562393161643530663763333131323537623734646363333636303965636136316335666237383565663835633436643861613665383132316630313135323030306564353365306234663034656262323538613462613538336166326565653566343239336533333932313133343036633665353361346561666539373639376339356437316362373239383331306435396563383437643964613161366635646666653161373532306132663035653966383939333434333137623961313630616439623562656639633438313339623739303932333965623363396663363766323238383938633133626665656531333238363164323664303363663933393538643435363637396239336132643630663362306439306430366466653230623630656230626464393030346462653861653734316538663231616532663562613032396536373635383866666631323336643162366339313365363939643666393264306465383132653735353961653231396565356164373538643562656235323430653233383666323462393531656233633561633366303865303862663732346435346263323861323737616234623566313865336566386634613364383337623939626266313036363830396231363332623530313832376634653637636330643535333561383039653530303164396466336434393330626662653930663932626334316234663238316432656132306238376262626366626235353466623963646338316536633032373634396134343838363738616231636632316234373262333163613733653062376461363332363763393537343261303863363063313965623133323739333936396238623238303937643834633036363931613539376536633431626333333264316230633936363632353537636534373238623430613337663430313562383234616364633035653161313135343063396133663538623662363338646437663565363732383339656235383938343330633432633437336137386336666433323766343437366461616138623164653632343737336266343561306465386633663361366132376239333263643564393937383932316635333561653363643534363662613066613765313735333839313238336666646532373863643638313737666139346162636334373861383736636339306137333565386130353139623535313363666562346630373963663931323037623639353035643162336266633238633632323533633462613639353964386561396137333038323463656336346639333939343635393935353031653031643332303235363461303834623831633532646138623164633963633936393339326234313330323364633734323930323339373666363066363032646165613066303130393565306561666334313665643531343331643864663361636365626661666162633431356365656436363731336237393965333530373064316136323333616165626539353464366637623735646439343537616162636235636364373135363265366664396536313263636639623431353862656665356231383632333236646336323832666338373765623438363430333431333861653063323061303630383332306237643233373435376231633038643839316636343839313865393836376266623265653164303464633437343134653135623830396565363939343064633432383538333431373366323639666361303435633566613432616364323164366662626464373565353738616435653136393063303736303335616463396434643536633233373934643537363235643566636430366530383239663936653966363037623339340000`

	payload, err := hex.DecodeString(payloadHex)

	if err != nil {
		t.Fatal(err)
	}

	err = VerifySignature([]byte(publicKeyString), []byte(payload), signature)

	if err != nil {
		t.Fatal(err)
	}
}
